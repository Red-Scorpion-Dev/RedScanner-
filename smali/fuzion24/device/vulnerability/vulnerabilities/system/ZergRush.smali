.class public Lfuzion24/device/vulnerability/vulnerabilities/system/ZergRush;
.super Ljava/lang/Object;
.source "ZergRush.java"

# interfaces
.implements Lfuzion24/device/vulnerability/vulnerabilities/VulnerabilityTest;


# direct methods
.method public constructor <init>()V
    .locals 0

    .prologue
    .line 14
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    return-void
.end method


# virtual methods
.method public getCVEorID()Ljava/lang/String;
    .locals 1

    .prologue
    .line 17
    const-string v0, "CVE-2011-3874"

    return-object v0
.end method

.method public getSupportedArchitectures()Ljava/util/List;
    .locals 2
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Lfuzion24/device/vulnerability/util/CPUArch;",
            ">;"
        }
    .end annotation

    .prologue
    .line 23
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 24
    .local v0, "archs":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lfuzion24/device/vulnerability/util/CPUArch;>;"
    sget-object v1, Lfuzion24/device/vulnerability/util/CPUArch;->ALL:Lfuzion24/device/vulnerability/util/CPUArch;

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 25
    return-object v0
.end method

.method public isVulnerable(Landroid/content/Context;)Z
    .locals 9
    .param p1, "context"    # Landroid/content/Context;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v8, 0x1

    const/4 v7, 0x0

    .line 31
    const-string v3, "/system/bin/vold"

    invoke-static {v3}, Lfuzion24/device/vulnerability/vulnerabilities/helper/SystemUtils;->ProcfindPidFor(Ljava/lang/String;)I

    move-result v1

    .line 32
    .local v1, "pid":I
    const-string v3, "storage"

    invoke-virtual {p1, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/os/storage/StorageManager;

    .line 34
    .local v2, "sm":Landroid/os/storage/StorageManager;
    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    move-result-object v3

    const-string v4, "getMountedObbPath"

    new-array v5, v8, [Ljava/lang/Class;

    const-class v6, Ljava/lang/String;

    aput-object v6, v5, v7

    invoke-virtual {v3, v4, v5}, Ljava/lang/Class;->getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;

    move-result-object v0

    .line 35
    .local v0, "getObbPath":Ljava/lang/reflect/Method;
    new-array v3, v8, [Ljava/lang/Object;

    const-string v4, "AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAAAAAA AAAA AAAA AAAA"

    aput-object v4, v3, v7

    invoke-virtual {v0, v2, v3}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;

    .line 47
    const-wide/16 v4, 0x7d0

    invoke-static {v4, v5}, Ljava/lang/Thread;->sleep(J)V

    .line 49
    return v7
.end method
